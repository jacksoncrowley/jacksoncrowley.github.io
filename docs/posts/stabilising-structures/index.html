
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Jackson Crowley</title>
    <link rel="stylesheet" href="/static/styles.css">
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                processEscapes: true
            }
        });
    </script>
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    
    
</head>
<body>
    <header>
        <h1>Jackson Crowley</h1>
        <hr>
    </header>

    <main class="post">
      <aside class="sidebar">
    <nav>
        <a href="/" >Home&nbsp;</a>
        <a href="/posts/" >Posts&nbsp;</a>
        <a href="/cv/" >CV&nbsp;</a>
    </nav>
</aside>
      <div class="content">
        <p>There are plenty of tricks one can exploit when trying to run MD simulations on starting structures that are, shall we say, less-than-stable. Such structures arise from the numerous and varied tools which are designed specifically for building membranes or complex biomolecular sructures, but you're far more likely to run in to problems when creating your own patchwork/frankenstein simulations, chopping and changing parts of various structures and sticking them back together again.</p>
<p>You'll quickly notice that coarse-grained forcefields such as Martini are far more resistant to inhumane treatment through brutal stabilisation methods, but in general, the below methods are broadly applicable. We'll start general, and get more specific.</p>
<h2 id="be-brutal-in-energy-minimisation">Be Brutal in Energy Minimisation</h2>
<pre><code>integrator    = steep
nsteps        = 10000
</code></pre>
<p>Without <code>emtol</code>, the energy minimisation will run for either <code>nsteps</code>, or until GROMACS is literally unable to compute the next step. In that case, you can also try switching the minimisation algorithm to <code>cg</code>, and running again, to see if it can continue. </p>
<h2 id="run-gromacs-in-double-precision">Run GROMACS in Double Precision</h2>
<p>Systems in which two particles almost perfectly overlap with one another can often lead to crashes as the integrator is simply unable to solve the possible next step, returning infinite forces and crashing the system. If GROMACS is compiled with double precision (found in the <a href="https://manual.gromacs.org/2024.4/install-guide/index.html#typical-installation">manual</a>), all positions, velocities, and forces are computed with many extra zeroes, which possibly resolves perfect overlaps. It's slower than regular mixed-precision GROMACS, so it's probably only worthwhile for your earliest stabilisation stages.</p>
<h2 id="slightly-decouple-everything">Slightly Decouple Everything</h2>
<p>This is a trick I picked up while on my research visit to TU Dortmund. For unstable initial configurations, where for instance you've simply added a peptide directly into a membrane system at the interface without deleting anything. The trick is slightly decouple all of the non-bonded parameters in the system, making violent, explosive reactions far less likely, as the intermolecular forces are greatly reduced.</p>
<pre><code>free-energy     = yes
couple-moltype  = system
couple-lambda0  = None  
couple-lambda1  = vdw-q
init-lambda     = 0.75 
</code></pre>
<p>At a lambda value of 1, all non-bonded interactions are on (Van der Waals and Coulomb, represented as <code>vdw-q</code>), but at lambda 0 they are fully switched off. We set the entire <code>system</code> to be coupled, and set the <code>init-lambda</code> to something lower than 1, reducing the strength of all non bonded interactions. </p>
<p>What you might not know is that this also works during energy minimisation!</p>
<h2 id="use-thermodynamic-slow-growth">Use Thermodynamic Slow Growth</h2>
<p>In the case where we are inserting one substance (i.e. a protein or ligand) into another (membrane, solvent), we can selectively decouple it and gradually increase the lambda value from 0 to 1, smoothly turning on the interactions. </p>
<pre><code>free-energy     = yes
couple-moltype  = molecule_0
couple-lambda0  = None  
couple-lambda1  = vdw-q
init-lambda     = 0.00
delta-lambda    = 0.01
</code></pre>
<p>Here, <code>delta-lambda</code> refers to the amount that the decoupled molecule's lambda value will increment per simulation step. In our example, the non-bonded interactions of <code>molecule_0</code> will turn on from 0 to 1 in 100 steps. </p>
<p>GROMACS will throw an error if the simulation would have the lambda value exceed 1. </p>
<p>A really, really important note is that if a single molecule is decoupled, you should consider it effectively in vacuum; no longer interacting with the rest of the molecules, it's free to fly around wherever it wishes. Consider restraining it in place with <a href="https://manual.gromacs.org/2024.4/reference-manual/functions/restraints.html">position restraints</a> if your <code>delta-lambda</code> process is rather slow <sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup>.</p>
<p>The <a href="https://manual.gromacs.org/2024.4/user-guide/mdp-options.html#free-energy-calculations">manual</a>, obviously, has plenty more information.</p>
<p>If you try all of these and the simulation is still not stable, I'd pretty confidently suggest that your structure has some very serious stability issues, likely in the bonded interactions. Until then, happy stabilisation!</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>A spherical flat-bottomed potential is great here; see my <a href="/posts/flat-bottomed-potentials-gromacs/">guide on how to implement them</a>.&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>
      </div>
    </main>
    <footer>
        <p>&copy; 2025 Jackson Crowley</p>
	      <div class="social-icons">
    		    <a href="https://github.com/jacksoncrowley" target="_blank">
    	    		  <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="github-icon">
        			      <path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path>
    			      </svg>
		        </a>
		        <a href="https://linkedin.com/in/jackson-crowley" target="_blank">
			      <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="linkedin-icon">
    				    <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
			      </svg>
		        </a>
                <a href="https://scholar.google.com/citations?user=baGMskoAAAAJ&hl=fr&authuser=1" target="_blank">
                  <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="scholar-icon">
                        <path d="M5.242 13.769L0 9.5 12 0l12 9.5-5.242 4.269C17.548 11.249 14.978 9.5 12 9.5c-2.977 0-5.548 1.749-6.758 4.269zM12 10a7 7 0 1 0 0 14 7 7 0 0 0 0-14z"/>
                        <path d="M10.5 16.5h3v-6h-3v6zm0 3h3v-2h-3v2z"/>
                  </svg>
                </a>
                <a href="https://x.com/jacksonlcrowley" target="_blank">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="x-icon">
                            <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                    </svg>
                </a>
	      </div>
    </footer>
</body>
</html>
